#TODO write a description for this script
#@author 
#@category _NEW_
#@keybinding 
#@menupath 
#@toolbar 


opcodes = [
    (0x0061CDB0, "nop"),
    (0x006B16A0, "ret"),
    (0x006B16E0, "sync"),
    (0x006B9974, "exit"),
    (0x006B16EC, "thread"),
    (0x006B892C, "va_start"),
    (0x006B8990, "va_end"),
    (0x006B8A64, "va_call"),
    (0x006B170C, "let"),
    (0x006B1724, "leti"),
    (0x006B1738, "letb"),
    (0x006B174C, "letw"),
    (0x006B1760, "leta"),
    (0x006B177C, "leto"),
    (0x006B179C, "set"),
    (0x006B17B0, "clear"),
    (0x006B17C4, "rev"),
    (0x006B17E8, "gset"),
    (0x006B17F8, "gclear"),
    (0x006B1808, "grev"),
    (0x006B182C, "glet"),
    (0x006B1854, "gget"),
    (0x006B1888, "add"),
    (0x006B18A0, "addi"),
    (0x006B18B4, "sub"),
    (0x006B18D0, "subi"),
    (0x006B18E8, "mul"),
    (0x006B1908, "muli"),
    (0x006B1920, "div"),
    (0x006B1944, "divi"),
    (0x006B1964, "and"),
    (0x006B197C, "andi"),
    (0x006B1990, "or"),
    (0x006B19A8, "ori"),
    (0x006B19BC, "xor"),
    (0x006B19D4, "xori"),
    (0x006B19E8, "mod"),
    (0x006B1A0C, "modi"),
    (0x006B1E98, "jmp"),
    (0x006B1EDC, "call"),
    (0x006B1A2C, "jmp_on"),
    (0x006B1AC8, "jmp_off"),
    (0x006B1B24, "jmp_eq"),
    (0x006B1B50, "jmpi_eq"),
    (0x006B1B78, "jmp_neq"),
    (0x006B1BA4, "jmpi_neq"),
    (0x006B1BCC, "ujmp_gt"),
    (0x006B1BF8, "ujmpi_gt"),
    (0x006B1C20, "jmp_gt"),
    (0x006B1C4C, "jmpi_gt"),
    (0x006B1C74, "ujmp_lt"),
    (0x006B1CA0, "ujmpi_lt"),
    (0x006B1CC8, "jmp_lt"),
    (0x006B1CF4, "jmpi_lt"),
    (0x006B1D1C, "ujmp_gte"),
    (0x006B1D48, "ujmpi_gte"),
    (0x006B1D70, "jmp_gte"),
    (0x006B1D9C, "jmpi_gte"),
    (0x006B1DC4, "ujmp_lte"),
    (0x006B1DF0, "ujmpi_lte"),
    (0x006B1E18, "jmp_lte"),
    (0x006B1E44, "jmpi_lte"),
    (0x006B1E6C, "switch_jmp"),
    (0x006B1EB0, "switch_call"),
    (0x006B1F1C, "stack_push"),
    (0x006B1F34, "stack_pop"),
    (0x006B1F48, "stack_pushm"),
    (0x006B200C, "stack_popm"),
    (0x006B8AD0, "arg_pushr"),
    (0x006B10C8, "arg_pushl"),
    (0x006B8B10, "arg_pushb"),
    (0x006B8B2C, "arg_pushw"),
    (0x006B8B48, "arg_pusha"),
    (0x006B8B70, "arg_pusho"),
    (0x006B8AF4, "arg_pushs"),
    (0x006B23F8, "message"),
    (0x006B206C, "list"),
    (0x006B2250, "fadein"),
    (0x006B2264, "fadeout"),
    (0x006B2278, "se"),
    (0x006B2294, "bgm"),
    (0x006B22A8, "window_msg"),
    (0x006B23A0, "add_msg"),
    (0x006B24F0, "mesend"),
    (0x006B3390, "gettime"),
    (0x006B25B0, "winend"),
    (0x006B25F8, "npc_crt_V3"),
    (0x006B9964, "npc_stop"),
    (0x006B2CEC, "npc_play"),
    (0x006B2D58, "npc_kill"),
    (0x006B2D68, "npc_nont"),
    (0x006B2D70, "npc_talk"),
    (0x006B2B90, "npc_crp_V3"),
    (0x006B325C, "create_pipe"),
    (0x006B309C, "p_hpstat_V3"),
    (0x006B3134, "p_dead_V3"),
    (0x006B319C, "p_disablewarp"),
    (0x006B31B0, "p_enablewarp"),
    (0x006B3030, "p_move_V3"),
    (0x006B2DA8, "p_look"),
    (0x006B993C, "p_action_disable"),
    (0x006B32A4, "p_action_enable"),
    (0x006B2D78, "disable_movement1"),
    (0x006B2D88, "enable_movement1"),
    (0x006B2D98, "p_noncol"),
    (0x006B2DA0, "p_col"),
    (0x006B31BC, "p_setpos"),
    (0x006B3920, "p_return_guild"),
    (0x006B393C, "p_talk_guild"),
    (0x006B3954, "npc_talk_pl_V3"),
    (0x006B39E0, "npc_talk_kill"),
    (0x006B2768, "npc_crtpk_V3"),
    (0x006B27B4, "npc_crppk_V3"),
    (0x006B2868, "npc_crptalk_v3"),
    (0x006B3014, "p_look_at_V1"),
    (0x006B2C38, "npc_crp_id_V3"),
    (0x006B2CFC, "cam_quake"),
    (0x006B2D50, "cam_adj"),
    (0x006B2D08, "cam_zmin"),
    (0x006B2D10, "cam_zmout"),
    (0x006B2D18, "cam_pan_V3"),
    (0x006B326C, "pos_pipe_V3"),
    (0x006B32CC, "if_zone_clear"),
    (0x006B3314, "chk_ene_num"),
    (0x006B3328, "unhide_obj"),
    (0x006B335C, "unhide_ene"),
    (0x006B3450, "at_coords_call"),
    (0x006B34BC, "at_coords_talk"),
    (0x006B3528, "col_npcin"),
    (0x006B3594, "col_npcinr"),
    (0x006B39F0, "switch_on"),
    (0x006B3A00, "switch_off"),
    (0x006B3A10, "playbgm_epi"),
    (0x006B3A30, "set_mainwarp"),
    (0x006B360C, "set_obj_param"),
    (0x006B3AB4, "set_floor_handler"),
    (0x006B3ACC, "clr_floor_handler"),
    (0x006B368C, "col_plinaw"),
    (0x006B375C, "hud_hide"),
    (0x006B3770, "hud_show"),
    (0x006B3784, "cine_enable"),
    (0x006B3790, "cine_disable"),
    (0x006B379C, "unknownA0"),
    (0x006B9930, "set_qt_failure"),
    (0x006B3ADC, "set_qt_success"),
    (0x006B9924, "clr_qt_failure"),
    (0x006B3AF4, "clr_qt_success"),
    (0x006B3AE8, "set_qt_cancel"),
    (0x006B3B00, "clr_qt_cancel"),
    (0x006B2DB8, "pl_walk_V3"),
    (0x006B3B0C, "pl_add_meseta"),
    (0x006B16FC, "thread_stg"),
    (0x006B3BA4, "del_obj_param"),
    (0x006B3BB8, "item_create"),
    (0x006B3CB4, "item_create2"),
    (0x006B3E30, "item_delete"),
    (0x006B3F94, "item_delete2"),
    (0x006B4120, "item_check"),
    (0x006B43E8, "setevt"),
    (0x006B4420, "get_difflvl"),
    (0x006B9918, "set_qt_exit"),
    (0x006B990C, "clr_qt_exit"),
    (0x006B2EA8, "particle_V3"),
    (0x006B3898, "npc_text"),
    (0x006B3744, "npc_chkwarp"),
    (0x006B374C, "pl_pkoff"),
    (0x006B42C0, "map_designate"),
    (0x006B42FC, "masterkey_on"),
    (0x006B430C, "masterkey_off"),
    (0x006B431C, "window_time"),
    (0x006B4324, "winend_time"),
    (0x006B432C, "winset_time"),
    (0x006B4340, "getmtime"),
    (0x006B4354, "set_quest_board_handler"),
    (0x006B4394, "clear_quest_board_handler"),
    (0x006B2F38, "particle_id_V3"),
    (0x006B29F4, "npc_crptalk_id_V3"),
    (0x006B3918, "npc_lang_clean"),
    (0x006B3754, "pl_pkon"),
    (0x006B41EC, "pl_chk_item2"),
    (0x006B4448, "enable_mainmenu"),
    (0x006B4458, "disable_mainmenu"),
    (0x006B4468, "start_battlebgm"),
    (0x006B4490, "end_battlebgm"),
    (0x006B230C, "disp_msg_qb"),
    (0x006B2384, "close_msg_qb"),
    (0x006B44B8, "set_eventflag_v3"),
    (0x006B44E0, "sync_leti"),
    (0x006B4598, "set_returnhunter"),
    (0x006B45B0, "set_returncity"),
    (0x006B38B0, "load_pvr"),
    (0x006B38E4, "load_midi"),
    (0x006B45C8, "unknownDE"),
    (0x006B2640, "npc_param_V3"),
    (0x006B4660, "pad_dragon"),
    (0x006B3A48, "clear_mainwarp"),
    (0x006B3A60, "pcam_param_V3"),
    (0x006B4668, "start_setevt_v3"),
    (0x006B46A0, "warp_on"),
    (0x006B46AC, "warp_off"),
    (0x006B46B8, "get_slotnumber"),
    (0x006B46CC, "get_servernumber"),
    (0x006B44B8, "set_eventflag2"),
    (0x006B19E8, "res"),
    (0x006B1A0C, "modi"),
    (0x006B3A20, "enable_bgmctrl"),
    (0x006B46E0, "sw_send"),
    (0x006B473C, "create_bgmctrl"),
    (0x006B3B64, "pl_add_meseta2"),
    (0x006B44E0, "sync_register"),
    (0x006B450C, "leti_fixed_camera_V3"),
    (0x006B4574, "default_camera_pos1"),
    (0x006B6448, "set_chat_callback"),
    (0x006B47AC, "get_difficulty_level2"),
    (0x006B47D4, "get_number_of_player1"),
    (0x006B47E8, "get_coord_of_player"),
    (0x006B48A8, "enable_map"),
    (0x006B48B4, "disable_map"),
    (0x006B48C0, "map_designate_ex"),
    (0x006B4964, "unknownF80E"),
    (0x006B497C, "unknownF80F"),
    (0x006B4994, "ba_initial_floor"),
    (0x006B98E4, "set_ba_rules"),
    (0x006B4A70, "unknownF812"),
    (0x006B4A94, "unknownF813"),
    (0x006B4AB8, "unknownF814"),
    (0x006B4ADC, "unknownF815"),
    (0x006B98C0, "unknownF816"),
    (0x006B4B00, "unknownF817"),
    (0x006B4B24, "unknownF818"),
    (0x006B4B48, "unknownF819"),
    (0x006B4B6C, "unknownF81A"),
    (0x006B4B90, "unknownF81B"),
    (0x006B4BB4, "ba_disp_msg"),
    (0x006B52EC, "death_lvl_up"),
    (0x006B52F8, "death_tech_lvl_up"),
    (0x006B4BC8, "cmode_stage"),
    (0x006B4BF4, "unknownF821"),
    (0x006B4C70, "unknownF823"),
    (0x006B4C80, "unknownF824"),
    (0x006B4C90, "exp_multiplication"),
    (0x006B4CC0, "exp_division"),
    (0x006B4CD4, "get_user_is_dead"),
    (0x006B4D08, "go_floor"),
    (0x006B4D80, "unknownF829"),
    (0x006B4DC0, "unknownF82A"),
    (0x006B4DE4, "unlock_door2"),
    (0x006B4E30, "lock_door2"),
    (0x006B4E7C, "if_switch_not_pressed"),
    (0x006B4EA4, "if_switch_pressed"),
    (0x006B4CE8, "control_dragon"),
    (0x006B4D00, "release_dragon"),
    (0x006B4ED4, "shrink"),
    (0x006B4F04, "unshrink"),
    (0x006B4F34, "unknownF83A"),
    (0x006B4FA4, "unknownF83B"),
    (0x006B50D8, "display_clock2"),
    (0x006B5314, "unknownF83D"),
    (0x006B5320, "delete_area_title"),
    (0x006B98B8, "load_npc_data"),
    (0x006B5014, "get_npc_data"),
    (0x006B50EC, "give_damage_score"),
    (0x006B5118, "take_damage_score"),
    (0x006B5144, "unk_score_F84A"),
    (0x006B5170, "unk_score_F84B"),
    (0x006B519C, "kill_score"),
    (0x006B51C8, "death_score"),
    (0x006B51F4, "unk_score_F84E"),
    (0x006B5220, "enemy_death_score"),
    (0x006B524C, "meseta_score"),
    (0x006B9888, "unknownF851"),
    (0x006B5278, "unknownF852"),
    (0x006B532C, "reverse_warps"),
    (0x006B5338, "unreverse_warps"),
    (0x006B5344, "set_ult_map"),
    (0x006B5350, "unset_ult_map"),
    (0x006B535C, "set_area_title"),
    (0x006B987C, "BA_Show_Self_Traps"),
    (0x006B9870, "BA_Hide_Self_Traps"),
    (0x006B536C, "equip_item"),
    (0x006B53C8, "unequip_item"),
    (0x006B53E0, "unknownF85C"),
    (0x006B53F8, "unknownF85D"),
    (0x006B5408, "unknownF85E"),
    (0x006B5424, "unknownF85F"),
    (0x006B5430, "unknownF860"),
    (0x006B5464, "unknownF861"),
    (0x006B54F4, "unknownF862"),
    (0x006B5570, "unknownF863"),
    (0x006B5634, "cmode_rank"),
    (0x006B564C, "award_item_name"),
    (0x006B5668, "award_item_select"),
    (0x006B5684, "award_item_give_to"),
    (0x006B56D8, "unknownF868"),
    (0x006B57E0, "unknownF869"),
    (0x006B5894, "item_create_cmode"),
    (0x006B5940, "unknownF86B"),
    (0x006B5954, "award_item_ok"),
    (0x006B5988, "unknownF86D"),
    (0x006B5994, "unknownF86E"),
    (0x006B528C, "ba_set_lives"),
    (0x006B52A0, "ba_set_tech_lvl"),
    (0x006B52BC, "ba_set_lvl"),
    (0x006B52D8, "ba_set_time_limit"),
    (0x006B59A0, "boss_is_dead"),
    (0x006B59CC, "unknownF874"),
    (0x006B5ADC, "unknownF875"),
    (0x006B5B0C, "unknownF876"),
    (0x006B5B3C, "enable_techs"),
    (0x006B5B64, "disable_techs"),
    (0x006B5B8C, "get_gender"),
    (0x006B5BF8, "get_chara_class"),
    (0x006B5CB8, "take_slot_meseta"),
    (0x006B5D60, "unknownF87C"),
    (0x006B5D88, "unknownF87D"),
    (0x006B5DA8, "clear"),
    (0x006B5DD0, "read_guildcard_flag"),
    (0x006B5E04, "unknownF880"),
    (0x006B5E30, "get_pl_name"),
    (0x006B5E84, "unknownF882"),
    (0x006B572C, "players_in_range"),
    (0x006B5EDC, "unknownF884"),
    (0x006B5F8C, "unknownF885"),
    (0x006B5FBC, "unknownF886"),
    (0x006B5FDC, "unknownF887"),
    (0x006B5FFC, "ba_close_msg"),
    (0x006B6008, "unknownF889"),
    (0x006B6014, "get_player_status"),
    (0x006B6218, "send_mail"),
    (0x006B635C, "online_check"),
    (0x006B6370, "chl_set_timerecord"),
    (0x006B6390, "chl_get_timerecord"),
    (0x006B63A4, "unknownF88F"),
    (0x006B3A58, "unknownF890"),
    (0x006B64C8, "load_enemy_data"),
    (0x006B64D8, "get_physical_data"),
    (0x006B657C, "get_attack_data"),
    (0x006B6638, "get_resist_data"),
    (0x006B66C4, "get_movement_data"),
    (0x006B674C, "unknownF896"),
    (0x006B6798, "unknownF897"),
    (0x006B67E4, "shift_left"),
    (0x006B6804, "shift_right"),
    (0x006B6824, "get_random"),
    (0x006B6898, "reset_map"),
    (0x006B68D8, "disp_chl_retry_menu"),
    (0x006B6924, "chl_reverser"),
    (0x006B692C, "unknownF89E"),
    (0x006B6948, "unknownF89F"),
    (0x006B6974, "unknownF8A0"),
    (0x006B6980, "unknownF8A1"),
    (0x006B698C, "unknownF8A2"),
    (0x006B69B8, "unknownF8A3"),
    (0x006B6F10, "unknownF8A4"),
    (0x006B69D4, "unknownF8A5"),
    (0x006B6A48, "unknownF8A6"),
    (0x006B6B30, "unknownF8A7"),
    (0x006B6BB0, "unknownF8A8"),
    (0x006B6BC8, "unknownF8A9"),
    (0x006B6BEC, "unknownF8AA"),
    (0x006B6C48, "unknownF8AB"),
    (0x006B6CE0, "unknownF8AC"),
    (0x006B6D18, "get_number_of_player2"),
    (0x006B6D2C, "unknownF8AE"),
    (0x006B6D64, "unknownF8AF"),
    (0x006B6D9C, "unknownF8B0"),
    (0x006B6DB8, "unknownF8B1"),
    (0x006B6DD4, "unknownF8B2"),
    (0x006B6DEC, "unknownF8B3"),
    (0x006B6DFC, "unknownF8B4"),
    (0x006B6E0C, "unknownF8B5"),
    (0x006B6E1C, "unknownF8B6"),
    (0x006B6EBC, "unknownF8B7"),
    (0x006B6ED0, "unknownF8B8"),
    (0x006B6ED8, "chl_recovery"),
    (0x006B6EE0, "unknownF8BA"),
    (0x006B6F00, "unknownF8BB"),
    (0x006B6F44, "set_episode"),
    (0x006B97F0, "QEXIT"),
    (0x006B6F7C, "use_animation"),
    (0x006B6FA0, "stop_animation"),
    (0x006B6FB8, "run_to_coord"),
    (0x006B7014, "set_slot_invincible"),
    (0x006B7034, "set_slot_targetable"),
    (0x006B704C, "set_slot_poison"),
    (0x006B7064, "set_slot_paralyze"),
    (0x006B707C, "set_slot_shock"),
    (0x006B7094, "set_slot_freeze"),
    (0x006B70AC, "set_slot_slow"),
    (0x006B70C4, "set_slot_confuse"),
    (0x006B70DC, "set_slot_shifta"),
    (0x006B70F4, "set_slot_deband"),
    (0x006B710C, "set_slot_jellen"),
    (0x006B7124, "set_slot_zalure"),
    (0x006B7204, "fleti_fixed_camera"),
    (0x006B7254, "fleti_locked_camera"),
    (0x006B7290, "default_camera_pos2"),
    (0x006B716C, "set_motion_blur"),
    (0x006B7188, "set_screen_bw"),
    (0x006B74C8, "unknownF8DB"),
    (0x006B7688, "NPC_action_string"),
    (0x006B7298, "get_pad_cond"),
    (0x006B73B0, "get_button_cond"),
    (0x006B76CC, "freeze_enemies"),
    (0x006B76E4, "unfreeze_enemies"),
    (0x006B76FC, "freeze_everything"),
    (0x006B7708, "unfreeze_everything"),
    (0x006B713C, "restore_hp"),
    (0x006B7154, "restore_tp"),
    (0x006B7190, "close_chat_bubble"),
    (0x006B71A8, "unknownF8E6"),
    (0x006B7714, "unknownF8E7"),
    (0x006B7798, "unknownF8E8"),
    (0x006B781C, "unknownF8E9"),
    (0x006B78A0, "unknownF8EA"),
    (0x006B7930, "unknownF8EB"),
    (0x006B79C4, "unknownF8EC"),
    (0x006B5F10, "animation_check"),
    (0x006B5F40, "call_image_data"),
    (0x006B5F7C, "turn_off_bgm_p2"),
    (0x006B5F84, "turn_on_bgm_p2"),
    (0x006B75A8, "load_unk_data"),
    (0x006B2E34, "particle2"),
    (0x006B7A88, "dec2float"),
    (0x006B7AA8, "float2dec"),
    (0x006B170C, "flet"),
    (0x006B1724, "fleti"),
    (0x006B7ADC, "fadd"),
    (0x006B7B04, "faddi"),
    (0x006B7B28, "fsub"),
    (0x006B7B50, "fsubi"),
    (0x006B7B74, "fmul"),
    (0x006B7B9C, "fmuli"),
    (0x006B7BC0, "fdiv"),
    (0x006B7BE8, "fdivi"),
    (0x006B7CEC, "get_unknown_count"),
    (0x006B7D18, "get_stackable_item_count"),
    (0x006B97D8, "freeze_and_hide_equip"),
    (0x006B97C0, "thaw_and_show_equip"),
    (0x006B7D70, "set_paletteX_callback"),
    (0x006B7D8C, "activate_paletteX"),
    (0x006B7D9C, "enable_paletteX"),
    (0x006B7DAC, "restore_paletteX"),
    (0x006B7DBC, "disable_paletteX"),
    (0x006B7DCC, "get_paletteX_activated"),
    (0x006B7DF0, "get_unknown_paletteX_status"),
    (0x006B7E14, "disable_movement2"),
    (0x006B7E30, "enable_movement2"),
    (0x006B80C4, "get_time_played"),
    (0x006B80F8, "get_guildcard_total"),
    (0x006B810C, "get_slot_meseta"),
    (0x006B8180, "get_player_level"),
    (0x006B81BC, "get_Section_ID"),
    (0x006B81F0, "get_player_hp"),
    (0x006B8280, "get_floor_number"),
    (0x006B9720, "get_coord_player_detect"),
    (0x006B82DC, "read_global_flag"),
    (0x006B8328, "write_global_flag"),
    (0x006B8360, "unknownF927"),
    (0x006B8408, "floor_player_detect"),
    (0x006B8450, "open_pack_select"),
    (0x006B8500, "item_select"),
    (0x006B8524, "get_item_id"),
    (0x006B8574, "color_change"),
    (0x006B8B98, "send_statistic"),
    (0x006B863C, "chat_box"),
    (0x006B8740, "chat_bubble"),
    (0x006B87FC, "unknownF932"),
    (0x006B8834, "scroll_text"),
    (0x006B7E4C, "add_damage_to"),
    (0x006B7EE0, "item_delete2"),
    (0x006B7F04, "get_item_info"),
    (0x006B7FB4, "item_packing1"),
    (0x006B801C, "item_packing2"),
    (0x006B80AC, "get_lang_setting"),
    (0x006B96F8, "prepare_statistic"),
    (0x006B8BC4, "keyword_detect"),
    (0x006B8BD4, "Keyword"),
    (0x006B8C10, "get_guildcard_num"),
    (0x006B8C44, "unknownF942"),
    (0x006B8CDC, "unknownF943"),
    (0x006B8CEC, "get_wrap_status"),
    (0x006B8D98, "initial_floor"),
    (0x006B7C0C, "sin"),
    (0x006B7C34, "cos"),
    (0x006B7C5C, "unknownF948"),
    (0x006B7C9C, "unknownF949"),
    (0x006B8E74, "boss_is_dead2"),
    (0x006B2EE8, "unknownF94B"),
    (0x006B2FA0, "unknownF94C"),
    (0x006B8EA0, "BB_p2_menu"),
    (0x006B4908, "BB_Map_Designate"),
    (0x006B8EB0, "BB_get_number_in_pack"),
    (0x006B8EEC, "BB_swap_item"),
    (0x006B8D48, "BB_check_wrap"),
    (0x006B8FA4, "BB_exchange_PD_item"),
    (0x006B920C, "BB_exchange_PD_srank"),
    (0x006B9294, "BB_exchange_PD_special"),
    (0x006B932C, "BB_exchange_PD_percent"),
    (0x006B93C4, "unknownF959"),
    (0x006B93D0, "unknownF95A"),
    (0x006B9018, "unknownF95B"),
    (0x006B90B8, "BB_exchange_SLT"),
    (0x006B93FC, "BB_exchange_PC"),
    (0x006B941C, "BB_box_create_BP"),
    (0x006B9104, "BB_exchange_PT"),
    (0x006B915C, "unknownF960"),
    (0x006B91F8, "unknownF961")
]

from ghidra.util import UndefinedFunction
from ghidra.util.task import ConsoleTaskMonitor
from ghidra.program.model.address import AddressSet
from ghidra.program.model.symbol import SourceType

fm = currentProgram.getFunctionManager()
tm = ConsoleTaskMonitor()

for (addr, opcode_name) in opcodes:
    addr = toAddr(addr)
    fn = fm.getFunctionAt(addr)
    new_fn_name = "opcode_" + opcode_name
    if fn:
        orig_name = fn.getName()
        if orig_name != new_fn_name:
            fn.setName(new_fn_name, SourceType.USER_DEFINED)
            print("renamed function " + orig_name + " to " + fn.getName() + " at " + addr.toString())
    else:
        orig_fn = UndefinedFunction.findFunctionUsingSimpleBlockModel(currentProgram, addr, tm)
        if not orig_fn:
            raise Exception("failed to find function for opcode " + opcode_name + " at " + addr.toString())
        entry = addr
        start = addr
        end = addr
        while True:
            addr = addr.add(1)
            fn = UndefinedFunction.findFunctionUsingSimpleBlockModel(currentProgram, addr, tm)
            if not fn or not fn.equals(orig_fn):
                break
            end = addr
        fn = fm.createFunction(new_fn_name, entry, AddressSet(start, end), SourceType.USER_DEFINED)
        print("created function " + fn.getName() + " at " + entry.toString())
        